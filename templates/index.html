<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Air Pollution Analysis Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>üåç Air Pollution Analysis Dashboard</h1>
            <p class="subtitle">Comparing PM2.5 and PM10 levels in New York City and Bogota</p>
            <p class="date-range">Data Period: September 2016 - April 2017</p>
        </header>

        <div class="tabs">
            <button class="tab-button" onclick="showTab('worldwide')">üåè Worldwide Search</button>
            <button class="tab-button" onclick="showTab('realtime')">üî¥ Live Monitor</button>
            <button class="tab-button active" onclick="showTab('overview')">Overview</button>
            <button class="tab-button" onclick="showTab('timeseries')">Time Series</button>
            <button class="tab-button" onclick="showTab('patterns')">Patterns</button>
            <button class="tab-button" onclick="showTab('comparison')">City Comparison</button>
            <button class="tab-button" onclick="showTab('who-limits')">WHO Limits</button>
        </div>

        <!-- Worldwide City Search Tab -->
        <div id="worldwide" class="tab-content">
            <div class="card">
                <h2>üåè Real-Time Air Quality - Any City Worldwide</h2>
                <p class="subtitle">Search for any city in the world to get real-time air quality data</p>
                
                <div class="search-container">
                    <input type="text" id="city-search" placeholder="Enter city name (e.g., London, Tokyo, New York)" />
                    <button onclick="searchCity()" class="search-button">üîç Search</button>
                </div>
                
                <div id="search-result" class="search-result">
                    <p class="info-text">üí° Try searching for: London, Paris, Tokyo, Delhi, Sydney, or any other city!</p>
                </div>
            </div>
            
            <div class="card">
                <h3>üåç Popular Cities Air Quality</h3>
                <div id="popular-cities" class="popular-cities-grid">
                    <div class="loading">Loading popular cities...</div>
                </div>
            </div>
            
            <div class="card">
                <h3>üìä Air Quality Map</h3>
                <div id="world-map" style="height: 500px;">
                    <div class="loading">Loading map...</div>
                </div>
            </div>
        </div>

        <!-- Real-Time Monitor Tab -->
        <div id="realtime" class="tab-content">
            <div class="card realtime-header">
                <h2>üî¥ Real-Time Air Quality Monitor</h2>
                <div class="realtime-status">
                    <span class="status-indicator"></span>
                    <span id="last-update">Connecting...</span>
                </div>
            </div>
            
            <div class="grid">
                <div class="card realtime-card" id="nyc-realtime">
                    <h2>üóΩ New York City</h2>
                    <div class="realtime-data">
                        <div class="loading">Connecting...</div>
                    </div>
                </div>
                <div class="card realtime-card" id="bogota-realtime">
                    <h2>üèîÔ∏è Bogota</h2>
                    <div class="realtime-data">
                        <div class="loading">Connecting...</div>
                    </div>
                </div>
            </div>
            
            <div class="card" id="alerts-container">
                <h3>‚ö†Ô∏è Active Alerts</h3>
                <div id="active-alerts">
                    <p class="no-alerts">No active alerts</p>
                </div>
            </div>
            
            <div class="card">
                <h3>üìà Live Trends (Last 10 Updates)</h3>
                <div id="realtime-chart"></div>
            </div>
        </div>

        <!-- Overview Tab -->
        <div id="overview" class="tab-content active">
            <div class="grid">
                <div class="card">
                    <h2>üóΩ New York City - Queens College</h2>
                    <div id="nyc-stats" class="stats-container">
                        <div class="loading">Loading...</div>
                    </div>
                </div>
                <div class="card">
                    <h2>üèîÔ∏è Bogota - San Cristobal</h2>
                    <div id="bogota-stats" class="stats-container">
                        <div class="loading">Loading...</div>
                    </div>
                </div>
            </div>
            <div class="card">
                <h3>üìä Key Insights</h3>
                <div id="insights" class="insights-container">
                    <div class="loading">Loading insights...</div>
                </div>
            </div>
        </div>

        <!-- Time Series Tab -->
        <div id="timeseries" class="tab-content">
            <div class="card">
                <h2>PM2.5 Time Series - Hourly Data</h2>
                <div class="controls">
                    <label>
                        <input type="checkbox" id="show-nyc" checked onchange="updateTimeSeries()"> 
                        Show NYC
                    </label>
                    <label>
                        <input type="checkbox" id="show-bogota" checked onchange="updateTimeSeries()"> 
                        Show Bogota
                    </label>
                </div>
                <div id="timeseries-plot"></div>
            </div>
            <div class="card">
                <h2>Daily Averages</h2>
                <div id="daily-plot"></div>
            </div>
        </div>

        <!-- Patterns Tab -->
        <div id="patterns" class="tab-content">
            <div class="grid">
                <div class="card">
                    <h3>Hourly Pattern (Average by Hour of Day)</h3>
                    <div id="hourly-plot"></div>
                </div>
                <div class="card">
                    <h3>Monthly Pattern</h3>
                    <div id="monthly-plot"></div>
                </div>
            </div>
        </div>

        <!-- Comparison Tab -->
        <div id="comparison" class="tab-content">
            <div class="card">
                <h2>NYC vs Bogota PM2.5 Levels</h2>
                <div id="comparison-stats" class="comparison-stats">
                    <div class="loading">Loading...</div>
                </div>
            </div>
            <div class="card">
                <h3>When is NYC pollution higher than Bogota?</h3>
                <div id="comparison-plot"></div>
            </div>
        </div>

        <!-- WHO Limits Tab -->
        <div id="who-limits" class="tab-content">
            <div class="card">
                <h2>WHO Air Quality Guidelines Compliance</h2>
                <p class="info">WHO 2021 Guidelines: PM2.5 Annual Mean ‚â§ 5 Œºg/m¬≥, 24-hour Mean ‚â§ 15 Œºg/m¬≥</p>
                <div class="grid">
                    <div class="who-card">
                        <h3>New York City</h3>
                        <div id="nyc-who" class="who-results">
                            <div class="loading">Loading...</div>
                        </div>
                    </div>
                    <div class="who-card">
                        <h3>Bogota</h3>
                        <div id="bogota-who" class="who-results">
                            <div class="loading">Loading...</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card">
                <h3>Exceedance Timeline</h3>
                <div id="exceedance-plot"></div>
            </div>
        </div>

        <footer>
            <p>Data Sources: New York State Department of Environmental Conservation | Bogota Air Quality Monitoring Network (RMCAB)</p>
            <p>WHO Air Quality Guidelines (2021) | Real-time Dashboard for Air Pollution Analysis</p>
        </footer>
    </div>

    <script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
</body>
</html>
